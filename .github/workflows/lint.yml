name: lint
on:
  push:
    branches:
      - master
    # paths:
    #   - "depl**.txt"
    #   - "**.env"
    #   - "!.cluster-secrets.sample.env"
    tags-ignore:
      - "flux-*"
# env:
#   DEBIAN_FRONTEND: "noninteractive"
#   KUBECONFIG: "./kubeconfig"
#   FLUX_FORWARD_NAMESPACE: "flux"
jobs:
  helmrelease:
    runs-on:
      - self-hosted
    if: "!contains(github.event.head_commit.message, '[ci-skip]')"
    steps:
      - uses: actions/checkout@v2
      - name: Lint
        run: |
          sudo curl -L -o hrval-all.sh https://raw.githubusercontent.com/stefanprodan/hrval-action/master/src/hrval-all.sh
          sudo chmod +x hrval-all.sh
          sudo curl -L -o hrval.sh https://raw.githubusercontent.com/stefanprodan/hrval-action/master/src/hrval.sh | sed -i 's/helmv3/helm'
          sudo chmod +x hrval.sh
          ./hrval-all.sh deployments false 1.18.8 v3
