---
access_control:
  default_policy: two_factor
  networks:
    - name: internal
      networks: ["10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
    # - name: cloudflare
    #   networks:
    #     - ["173.245.48.0/20", "103.21.244.0/22", "103.22.200.0/22", "103.31.4.0/22", "141.101.64.0/18", "108.162.192.0/18", "190.93.240.0/20", "188.114.96.0/20", "197.234.240.0/22", "198.41.128.0/17", "162.158.0.0/15", "104.16.0.0/13", "104.24.0.0/14", "172.64.0.0/13", "131.0.72.0/22"]
    #     - ["2400:cb00::/32", "2606:4700::/32", "2803:f800::/32", "2405:b500::/32", "2405:8100::/32", "2a06:98c0::/29", "2c0f:f248::/32"]
    # - name: uptimerobot
    #   networks:
    #     - ["216.144.250.150/32", "69.162.124.226/32", "69.162.124.227/32", "69.162.124.228/32", "69.162.124.229/32", "69.162.124.230/32", "69.162.124.231/32", "69.162.124.232/32", "69.162.124.233/32", "69.162.124.234/32", "69.162.124.235/32", "69.162.124.236/32", "69.162.124.237/32", "63.143.42.242/32", "63.143.42.243/32", "63.143.42.244/32", "63.143.42.245/32", "63.143.42.246/32", "63.143.42.247/32", "63.143.42.248/32", "63.143.42.249/32", "63.143.42.250/32", "63.143.42.251/32", "63.143.42.252/32", "63.143.42.253/32", "216.245.221.82/32", "216.245.221.83/32", "216.245.221.84/32", "216.245.221.85/32", "216.245.221.86/32", "216.245.221.87/32", "216.245.221.88/32", "216.245.221.89/32", "216.245.221.90/32", "216.245.221.91/32", "216.245.221.92/32", "216.245.221.93/32", "208.115.199.18/32", "208.115.199.19/32", "208.115.199.20/32", "208.115.199.21/32", "208.115.199.22/32", "208.115.199.23/32", "208.115.199.24/32", "208.115.199.25/32", "208.115.199.26/32", "208.115.199.27/32", "208.115.199.28/32", "208.115.199.29/32", "208.115.199.30/32", "46.137.190.132/32", "122.248.234.23/32", "167.99.209.234/32", "178.62.52.237/32", "54.79.28.129/32", "54.94.142.218/32", "104.131.107.63/32", "54.67.10.127/32", "54.64.67.106/32", "159.203.30.41/32", "46.101.250.135/32", "18.221.56.27/32", "52.60.129.180/32", "159.89.8.111/32", "146.185.143.14/32", "139.59.173.249/32", "165.227.83.148/32", "128.199.195.156/32", "138.197.150.151/32", "34.233.66.117/32", "52.70.84.165/32", "54.225.82.45/32"]
    #     - ["2607:ff68:107::3/128", "2607:ff68:107::4/128", "2607:ff68:107::5/128", "2607:ff68:107::6/128", "2607:ff68:107::7/128", "2607:ff68:107::8/128", "2607:ff68:107::9/128", "2607:ff68:107::10/128", "2607:ff68:107::11/128", "2607:ff68:107::12/128", "2607:ff68:107::13/128", "2607:ff68:107::14/128", "2607:ff68:107::15/128", "2607:ff68:107::16/128", "2607:ff68:107::17/128", "2607:ff68:107::18/128", "2607:ff68:107::19/128", "2607:ff68:107::20/128", "2607:ff68:107::21/128", "2607:ff68:107::22/128", "2607:ff68:107::23/128", "2607:ff68:107::24/128", "2607:ff68:107::25/128", "2607:ff68:107::26/128", "2607:ff68:107::27/128", "2607:ff68:107::28/128", "2607:ff68:107::29/128", "2607:ff68:107::30/128", "2607:ff68:107::31/128", "2607:ff68:107::32/128", "2607:ff68:107::33/128", "2607:ff68:107::34/128", "2607:ff68:107::35/128", "2607:ff68:107::36/128", "2607:ff68:107::37/128", "2607:ff68:107::38/128", "2607:ff68:107::39/128", "2607:ff68:107::40/128", "2607:ff68:107::41/128", "2607:ff68:107::42/128", "2607:ff68:107::43/128", "2607:ff68:107::44/128", "2607:ff68:107::45/128", "2607:ff68:107::46/128", "2607:ff68:107::47/128", "2607:ff68:107::48/128", "2607:ff68:107::49/128", "2607:ff68:107::50/128", "2607:ff68:107::51/128", "2607:ff68:107::52/128", "2607:ff68:107::53/128", "2607:ff68:107::54/128", "2607:ff68:107::55/128", "2a03:b0c0:2:d0::fa3:e001/128", "2a03:b0c0:1:d0::e54:a001/128", "2604:a880:800:10::4e6:f001/128", "2604:a880:cad:d0::122:7001/128", "2a03:b0c0:3:d0::33e:4001/128", "2600:1f16:775:3a01:70d6:601a:1eb5:dbb9/128", "2600:1f11:56a:9000:23:651b:dac0:9be4/128", "2a03:b0c0:3:d0::44:f001/128", "2a03:b0c0:0:1010::2b:b001/128", "2a03:b0c0:1:d0::22:5001/128", "2604:a880:400:d0::4f:3001/128", "2400:6180:0:d0::16:d001/128", "2604:a880:cad:d0::18:f001/128", "2600:1f18:179:f900:88b2:b3d:e487:e2f4/128"]

  rules:
    - domain:
        - "lidarr.${SECRET_PUBLIC_DOMAIN}"
        - "prowlarr.${SECRET_PUBLIC_DOMAIN}"
        - "readarr.${SECRET_PUBLIC_DOMAIN}"
        - "radarr.${SECRET_PUBLIC_DOMAIN}"
        - "radarr-uhd.${SECRET_PUBLIC_DOMAIN}"
        - "sabnzbd.${SECRET_PUBLIC_DOMAIN}"
        - "sonarr.${SECRET_PUBLIC_DOMAIN}"
        - "sonarr-uhd.${SECRET_PUBLIC_DOMAIN}"
      policy: bypass
      resources: ["^/api([?/].*)?$"]

    - domain: "*.${SECRET_PUBLIC_DOMAIN}"
      policy: bypass
      networks: ["internal"]

identity_providers:
  oidc:
    cors:
      endpoints:
        - authorization
        - token
        - revocation
        - introspection
      allowed_origins_from_client_redirect_uris: true
    clients:
      - id: grafana
        description: Grafana
        secret: "${SECRET_GRAFANA_OAUTH_CLIENT_SECRET}"
        public: false
        authorization_policy: two_factor
        pre_configured_consent_duration: 1y
        scopes:
          - openid
          - profile
          - groups
          - email
        redirect_uris:
          - "https://grafana.${SECRET_PUBLIC_DOMAIN}/login/generic_oauth"
        userinfo_signing_algorithm: none
