apiVersion: cr.kanister.io/v1alpha1
kind: Blueprint
metadata:
  name: cloud-sync
  namespace: kasten-io
actions:
  post-export:
    kind: Namespace
    phases:
    - func: KubeTask
      name: hookPhase
      args:
        podOverride:
          serviceAccountName: "k10-k10"
        image: ghcr.io/k8s-at-home/kubectl:v1.21.3
        command:
        - "/bin/sh"
        - "-ec"
        - |
          kubectl create job --from=cronjob/cloud-sync cloud-sync-$(date '+%s') -n kasten-io
